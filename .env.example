# ============================================================
# Rezeis Panel - Unified Environment Configuration
# ============================================================
# This file follows the same pattern as altshop bot configuration
# All settings are centralized in one place
# 
# IMPORTANT: With nginx reverse proxy, all services are accessed
# through port 443 (HTTPS). No direct port access needed.
# ============================================================

# ============================================================
# APP - General Application Settings
# ============================================================
NODE_ENV=production
APP_DOMAIN=your-domain.com

# ============================================================
# FRONTEND - React App Configuration
# ============================================================
# With nginx proxy, use relative paths or wss:// for WebSocket
VITE_API_URL=/api
VITE_WS_URL=wss://${APP_DOMAIN}/ws

# ============================================================
# PORTS - Internal Service Ports (not exposed externally)
# ============================================================
# These ports are internal to Docker network only
# Backend API Server (internal)
APP_BACKEND_PORT=4000
# Frontend Web App (internal, served via nginx)
APP_FRONTEND_PORT=4001
# Mini App (internal, served via nginx)
APP_MINIAPP_PORT=4002
# WebSocket Server (internal)
APP_WEBSOCKET_PORT=4003

# ============================================================
# DATABASE - PostgreSQL Configuration
# ============================================================
# Internal Docker network access only (no port exposed)
DATABASE_HOST=postgres
DATABASE_PORT=5432
DATABASE_NAME=rezeis_panel
DATABASE_USER=rezeis
DATABASE_PASSWORD=your_secure_database_password
# Full URL (constructed from above or override)
DATABASE_URL=postgresql://${DATABASE_USER}:${DATABASE_PASSWORD}@${DATABASE_HOST}:${DATABASE_PORT}/${DATABASE_NAME}

# Connection Pool Settings
DATABASE_POOL_SIZE=10
DATABASE_MAX_OVERFLOW=20
DATABASE_POOL_TIMEOUT=30

# ============================================================
# VALKEY - Cache & Session Store (Redis-compatible)
# ============================================================
# Internal Docker network access only (no port exposed)
VALKEY_HOST=valkey
VALKEY_PORT=6379
VALKEY_DB=0
VALKEY_PASSWORD=your_secure_valkey_password
VALKEY_MAX_CONNECTIONS=10
# Full URL (constructed from above or override)
VALKEY_URL=valkey://${VALKEY_HOST}:${VALKEY_PORT}/${VALKEY_DB}

# Redis (backward compatibility - will be deprecated)
REDIS_HOST=${VALKEY_HOST}
REDIS_PORT=${VALKEY_PORT}
REDIS_NAME=${VALKEY_DB}
REDIS_PASSWORD=${VALKEY_PASSWORD}
REDIS_URL=redis://${VALKEY_HOST}:${VALKEY_PORT}/${VALKEY_DB}

# ============================================================
# JWT - Authentication Configuration
# ============================================================
JWT_SECRET=your-super-secret-jwt-key-minimum-32-characters-long
JWT_EXPIRES_IN=7d
JWT_REFRESH_SECRET=your-super-secret-refresh-key-minimum-32-chars
JWT_REFRESH_EXPIRES_IN=30d

# ============================================================
# REMNAWAVE - VPN Panel Integration
# ============================================================
# Host (Docker internal name 'remnawave' or external domain)
REMNAWAVE_HOST=remnawave
# Port (3000 is default for Remnawave, but can be changed if needed)
REMNAWAVE_PORT=3000
# API Token from Remnawave panel
REMNAWAVE_TOKEN=your_remnawave_api_token_here
# Webhook Secret for receiving events
REMNAWAVE_WEBHOOK_SECRET=your_webhook_secret_here
# Caddy Token for X-Api-Key header (optional)
REMNAWAVE_CADDY_TOKEN=
# Cookie for authentication (optional, format: name=value)
REMNAWAVE_COOKIE=

# Sync Settings
REMNAWAVE_SYNC_INTERVAL_MINUTES=5
REMNAWAVE_SYNC_ENABLED=true

# ============================================================
# TELEGRAM - Bot Integration
# ============================================================
TELEGRAM_BOT_TOKEN=your_telegram_bot_token_from_botfather
TELEGRAM_WEBHOOK_SECRET=your_telegram_webhook_secret
# Mini App URL - use your domain with /miniapp/ path
TELEGRAM_MINI_APP_URL=https://${APP_DOMAIN}/miniapp/

# ============================================================
# ACCESS - Super Admin Configuration
# ============================================================
# Super Admin Telegram ID(s) - full access to all settings
# Comma-separated for multiple IDs (e.g., "123456789,987654321")
SUPER_ADMIN_TELEGRAM_ID=123456789

# ============================================================
# SECURITY - Rate Limiting & CORS
# ============================================================
RATE_LIMIT_MAX=1000
RATE_LIMIT_WINDOW_MS=60000
# CORS origins - your domain only
CORS_ORIGINS=https://${APP_DOMAIN}

# ============================================================
# LOGGING - Application Logs
# ============================================================
LOG_LEVEL=info
LOG_FORMAT=json

# ============================================================
# FEATURE FLAGS - Enable/Disable Features
# ============================================================
FEATURE_PAYMENTS_ENABLED=true
FEATURE_REFERRAL_ENABLED=true
FEATURE_PARTNER_ENABLED=true
FEATURE_WEBSOCKET_ENABLED=true

# ============================================================
# BACKUP - Automated Backups
# ============================================================
# Enable automated backups
BACKUP_ENABLED=false
# Backup interval in hours (default: 24)
BACKUP_INTERVAL_HOURS=24
# Backup time (HH:MM format, default: 03:00)
BACKUP_TIME=03:00
# Max number of local backups to keep (default: 7)
BACKUP_MAX_KEEP=7
# Backup storage location (default: ./backups)
BACKUP_LOCATION=./backups
# Compress backups with gzip (default: true)
BACKUP_COMPRESSION=true

# What to backup (comma-separated list, 'all' for everything)
# Options: all, users, subscriptions, transactions, plans, partners, referrals, settings, statistics
BACKUP_INCLUDE_TABLES=all

# Send backups to Telegram
BACKUP_TELEGRAM_ENABLED=false
# Telegram chat ID (channel username or numeric ID)
BACKUP_TELEGRAM_CHAT_ID=
# Telegram topic ID for forum channels (optional)
BACKUP_TELEGRAM_TOPIC_ID=

# Send backups to S3 (optional)
BACKUP_S3_ENABLED=false
BACKUP_S3_BUCKET=
BACKUP_S3_REGION=
BACKUP_S3_ACCESS_KEY=
BACKUP_S3_SECRET_KEY=
BACKUP_S3_ENDPOINT=

# ============================================================
# NGINX - SSL Certificate Configuration
# ============================================================
# Place your SSL certificates in rezeis/nginx/ssl/:
# - rezeis_fullchain.pem (certificate + intermediates)
# - rezeis_privkey.key (private key)
#
# You can obtain free certificates from Let's Encrypt:
# certbot certonly --standalone -d your-domain.com
# Then copy to nginx/ssl/ directory
# ============================================================
